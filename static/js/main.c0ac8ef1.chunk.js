(this.webpackJsonptest=this.webpackJsonptest||[]).push([[0],{16:function(e,t,a){},19:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(9),l=a.n(s),i=(a(16),a(2)),o=a(3),c=a(1),u=a(5),d=a(4),p=a.p+"static/media/logo.103b5fa1.svg",m=(a(8),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).listen(),n}return Object(o.a)(a,[{key:"listen",value:function(){var e={};e.tempOpen=XMLHttpRequest.prototype.open,e.tempSend=XMLHttpRequest.prototype.send,e.callback=function(){this.url.includes("api/")&&a.log(this.method,this.url.split("api/")[0]+"api/",this.data,this.url.split("api/")[1])},XMLHttpRequest.prototype.open=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.tempOpen.apply(this,arguments),e.method=t,e.url=a,"get"===t.toLowerCase()&&(e.data=a.split("?"),e.data=e.data[1])},XMLHttpRequest.prototype.send=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e.tempSend.apply(this,arguments),"post"===e.method.toLowerCase()&&(e.data=t),e.callback()}}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("button",{onClick:a.clear.bind(this)},"clear"),r.a.createElement("ul",null,a.messageLog?a.messageLog.map((function(e,t){return r.a.createElement("li",{key:e.method+t}," ",r.a.createElement("b",null,e.method,":")," ",e.url,r.a.createElement("b",null,e.message)," ",r.a.createElement("br",null))})):r.a.createElement("li",null,"No REST calls yet")))}}],[{key:"log",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"N/A",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"N/A",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"N/A",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this.messageLog.push({method:e,url:t,message:n,data:a})}},{key:"clear",value:function(){a.messageLog=[],this.forceUpdate()}}]),a}(n.Component));m.messageLog=[];var h=a(10),g={users:null,username:"",password:"",url:"https://env-nnnnnn.customer.cloud.microstrategy.com/MicroStrategyLibrary/api/",loginToken:null},f=Object(h.a)((function(e,t){switch(t.type){case"update_users":return Object.assign({},e,{users:t.newUsers});case"update_token":return Object.assign({},e,{loginToken:t.token});case"set_url":return Object.assign({},e,{url:t.loginParam});case"set_username":return console.log(t),Object.assign({},e,{username:t.loginParam});case"set_password":return Object.assign({},e,{password:t.loginParam});default:return e}}),g,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),v=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).updateLoginParams=n.updateLoginParams.bind(Object(c.a)(n)),n.login=n.login.bind(Object(c.a)(n)),n.formSubmit=n.formSubmit.bind(Object(c.a)(n)),n.state={display:"flex"},n}return Object(o.a)(a,[{key:"getUsers",value:function(e){var t=e;e.props.callRest("GET","users","",(function(){if(this.readyState===XMLHttpRequest.DONE)try{var e=JSON.parse(this.responseText);f.dispatch({type:"update_users",newUsers:e}),Array.isArray(e)?t.setState({display:"none"}):alert("login failed")}catch(a){alert("login failed!"),t.setState({display:"flex"})}}))}},{key:"login",value:function(){var e=this;return new Promise((function(t,a){if(!f.getState().loginToken)try{e.props.callRest("POST","auth/login",JSON.stringify({loginMode:1,username:f.getState().username,password:f.getState().password}),(function(){this.readyState===XMLHttpRequest.DONE&&(f.dispatch({type:"update_token",token:this.getResponseHeader("X-MSTR-AuthToken")}),f.getState().loginToken?t():alert("login failed!"))}))}catch(n){alert("login failed!")}}))}},{key:"updateLoginParams",value:function(e,t){f.dispatch({type:e,loginParam:t.target.value})}},{key:"formSubmit",value:function(e){var t=this,a=this;e.preventDefault(),this.login().then((function(){return t.getUsers(a)}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"login-backdrop",style:{display:this.state.display}},r.a.createElement("div",{className:"login-form"},r.a.createElement("div",{className:"panel-title"},"Log In"),r.a.createElement("form",{onSubmit:this.formSubmit,style:{padding:"5px"}},r.a.createElement("label",null,r.a.createElement("input",{type:"text",placeholder:"REST API URL",defaultValue:f.getState().url,onChange:function(t){return e.updateLoginParams("set_url",t)}}),r.a.createElement("br",null),r.a.createElement("input",{type:"text",placeholder:"username",defaultValue:f.getState().username,onChange:function(t){return e.updateLoginParams("set_username",t)}}),r.a.createElement("br",null),r.a.createElement("input",{type:"password",placeholder:"password",defaultValue:f.getState().password,onChange:function(t){return e.updateLoginParams("set_password",t)}}),r.a.createElement("br",null)),r.a.createElement("input",{type:"submit",value:"Login"}))))}}]),a}(n.Component),y=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).callRest=n.callRest.bind(Object(c.a)(n)),n.updateUserId=n.updateUserId.bind(Object(c.a)(n)),n.handleChangeName=n.handleChangeName.bind(Object(c.a)(n)),n.renderPropertyValue=n.renderPropertyValue.bind(Object(c.a)(n)),n.patchName=n.patchName.bind(Object(c.a)(n)),n.state={selectedUserId:"",selectedUserInfo:{},newName:""},n}return Object(o.a)(a,[{key:"callRest",value:function(e,t,a,n){t.startsWith("/")&&(t=t.substr(1));var r=new XMLHttpRequest;r.open(e,f.getState().url+t),r.setRequestHeader("Content-type","application/json"),r.setRequestHeader("Accept","application/json"),r.withCredentials=!0;var s=f.getState().loginToken;s&&r.setRequestHeader("X-MSTR-AuthToken",s),r.onreadystatechange=n;try{r.send(a)}catch(l){console.log(l),alert("error: could not send http request")}}},{key:"cleanPropertyName",value:function(e){return(e=e.charAt(0).toUpperCase()+e.substr(1)).replace(/([A-Z]+)/g," $1").replace(/([A-Z][a-z])/g," $1")}},{key:"patchName",value:function(){var e=this.state.selectedUserInfo.id,t={operationList:[{op:"REPLACE",path:"/fullName",value:this.state.newName}]};this.callRest("PATCH","users/"+e,JSON.stringify(t),(function(){this.readyState===XMLHttpRequest.DONE&&alert("Name has been updated")}));var a=this.state.selectedUserId,n=f.getState().users.findIndex((function(e){return e.id===a})),r=f.getState().users;r[n].name=this.state.newName,f.dispatch({type:"update_users",newUsers:r})}},{key:"handleChangeName",value:function(e){this.setState({newName:e.target.value}),"Enter"===e.key&&this.patchName()}},{key:"renderPropertyValue",value:function(e,t){if(e.indexOf("date")>=0)try{return new Date(t).toLocaleString()}catch(a){}else if("fullName"===e)return r.a.createElement("input",{type:"text",defaultValue:t,key:this.state.selectedUserInfo.id,onChange:this.handleChangeName});return t}},{key:"updateUserId",value:function(e){this.setState({selectedUserId:e});var t=this;e&&this.callRest("GET","users/"+e,"",(function(){this.readyState===XMLHttpRequest.DONE&&t.setState({selectedUserInfo:JSON.parse(this.responseText)})}))}},{key:"render",value:function(){var e=this,t=[],a=this.state.selectedUserInfo,n="none";if(a&&a.id)try{["username","fullName","id","abbreviation","dateCreated","dateModified"].forEach((function(n,s){return a[n]?t.push(r.a.createElement("tr",{key:a.id+s},r.a.createElement("td",null,e.cleanPropertyName(n)),r.a.createElement("td",null,e.renderPropertyValue(n,a[n])))):null})),n="table"}catch(s){console.log(s)}return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("img",{src:p,className:"App-logo",alt:"logo"}),r.a.createElement("span",{className:"App-title"},"React User Manager"),r.a.createElement("img",{src:p,className:"App-logo",alt:"logo"})),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"fixed"},r.a.createElement("div",{className:"panel-title"},"List of Users",r.a.createElement("div",{className:"subtitle"},"Select user below to get user information")),r.a.createElement("ul",null,f.getState().users&&Array.isArray(f.getState().users)&&f.getState().users.length>0?f.getState().users.map(function(e){var t=this;return r.a.createElement("li",{className:"user",key:e.id,onClick:function(){return t.updateUserId(e.id)}}," ",e.name," ")}.bind(this)):r.a.createElement("li",null,"No users available"))),r.a.createElement("div",{className:"flex-item"},r.a.createElement("div",{className:"panel-title"},"User Properties"),r.a.createElement("table",{className:"user-editor",style:{display:n}},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Property"),r.a.createElement("th",null,"Value"))),r.a.createElement("tbody",null,t)),r.a.createElement("button",{className:"submit-button user-editor",style:{display:n},onClick:this.patchName},"Update Name")),r.a.createElement("div",{className:"right-panel"},r.a.createElement("div",{className:"panel-title"},"REST Call Log"),r.a.createElement(m,null))),r.a.createElement(v,{callRest:this.callRest}))}}]),a}(n.Component),b=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function E(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var N=function(){return l.a.render(r.a.createElement(y,null),document.getElementById("root"))};!function(){if("serviceWorker"in navigator){if(new URL(".",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat(".","/service-worker.js");b?function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):E(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e):E(e)}))}}(),N(),f.subscribe(N)},8:function(e,t,a){}},[[19,1,2]]]);
//# sourceMappingURL=main.c0ac8ef1.chunk.js.map