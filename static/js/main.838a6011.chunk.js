(this["webpackJsonpuser-manager"]=this["webpackJsonpuser-manager"]||[]).push([[0],{17:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var s=a(2),n=a.n(s),r=a(10),i=a.n(r),l=(a(17),a(3)),c=a(4),o=a(1),u=a(6),d=a(5),p=a.p+"static/media/logo.6ce24c58.svg",h=(a(9),a(0)),j=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(l.a)(this,a),(s=t.call(this,e)).listen(),s}return Object(c.a)(a,[{key:"listen",value:function(){var e={};e.tempOpen=XMLHttpRequest.prototype.open,e.tempSend=XMLHttpRequest.prototype.send,e.callback=function(){this.url.includes("api/")&&a.log(this.method,this.url.split("api/")[0]+"api/",this.data,this.url.split("api/")[1])},XMLHttpRequest.prototype.open=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.tempOpen.apply(this,arguments),e.method=t,e.url=a,"get"===t.toLowerCase()&&(e.data=a.split("?"),e.data=e.data[1])},XMLHttpRequest.prototype.send=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e.tempSend.apply(this,arguments),"post"===e.method.toLowerCase()&&(e.data=t),e.callback()}}},{key:"render",value:function(){return Object(h.jsxs)("div",{children:[Object(h.jsx)("button",{onClick:a.clear.bind(this),children:"clear"}),Object(h.jsx)("ul",{children:a.messageLog?a.messageLog.map((function(e,t){return Object(h.jsxs)("li",{children:[" ",Object(h.jsxs)("b",{children:[e.method,":"]})," ",e.url,Object(h.jsx)("b",{children:e.message})," ",Object(h.jsx)("br",{})]},e.method+t)})):Object(h.jsx)("li",{children:"No REST calls yet"})})]})}}],[{key:"log",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"N/A",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"N/A",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"N/A",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this.messageLog.push({method:e,url:t,message:s,data:a})}},{key:"clear",value:function(){a.messageLog=[],this.forceUpdate()}}]),a}(s.Component);j.messageLog=[];var b=a(11),g={users:null,username:"",password:"",url:"https://env-nnnnnn.customer.cloud.microstrategy.com/MicroStrategyLibrary/api/",loginToken:null},m=Object(b.a)((function(e,t){switch(t.type){case"update_users":return Object.assign({},e,{users:t.newUsers});case"update_token":return Object.assign({},e,{loginToken:t.token});case"set_url":return Object.assign({},e,{url:t.loginParam});case"set_username":return console.log(t),Object.assign({},e,{username:t.loginParam});case"set_password":return Object.assign({},e,{password:t.loginParam});default:return e}}),g,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),O=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(l.a)(this,a),(s=t.call(this,e)).updateLoginParams=s.updateLoginParams.bind(Object(o.a)(s)),s.login=s.login.bind(Object(o.a)(s)),s.formSubmit=s.formSubmit.bind(Object(o.a)(s)),s.state={display:"flex"},s}return Object(c.a)(a,[{key:"getUsers",value:function(e){var t=e;e.props.callRest("GET","users","",(function(){if(this.readyState===XMLHttpRequest.DONE)try{var e=JSON.parse(this.responseText);m.dispatch({type:"update_users",newUsers:e}),Array.isArray(e)?t.setState({display:"none"}):alert("login failed")}catch(a){alert("login failed!"),t.setState({display:"flex"})}}))}},{key:"login",value:function(){var e=this;return new Promise((function(t,a){if(!m.getState().loginToken)try{e.props.callRest("POST","auth/login",JSON.stringify({loginMode:1,username:m.getState().username,password:m.getState().password}),(function(){this.readyState===XMLHttpRequest.DONE&&(m.dispatch({type:"update_token",token:this.getResponseHeader("X-MSTR-AuthToken")}),m.getState().loginToken?t():alert("login failed!"))}))}catch(s){alert("login failed!")}}))}},{key:"updateLoginParams",value:function(e,t){m.dispatch({type:e,loginParam:t.target.value})}},{key:"formSubmit",value:function(e){var t=this,a=this;e.preventDefault(),this.login().then((function(){return t.getUsers(a)}))}},{key:"render",value:function(){var e=this;return Object(h.jsx)("div",{className:"login-backdrop",style:{display:this.state.display},children:Object(h.jsxs)("div",{className:"login-form",children:[Object(h.jsx)("div",{className:"panel-title",children:"Log In"}),Object(h.jsxs)("form",{onSubmit:this.formSubmit,style:{padding:"5px"},children:[Object(h.jsxs)("label",{children:[Object(h.jsx)("input",{type:"text",placeholder:"REST API URL",defaultValue:m.getState().url,onChange:function(t){return e.updateLoginParams("set_url",t)}}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"text",placeholder:"username",defaultValue:m.getState().username,onChange:function(t){return e.updateLoginParams("set_username",t)}}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"password",placeholder:"password",defaultValue:m.getState().password,onChange:function(t){return e.updateLoginParams("set_password",t)}}),Object(h.jsx)("br",{})]}),Object(h.jsx)("input",{type:"submit",value:"Login"})]})]})})}}]),a}(s.Component),f=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(l.a)(this,a),(s=t.call(this,e)).callRest=s.callRest.bind(Object(o.a)(s)),s.updateUserId=s.updateUserId.bind(Object(o.a)(s)),s.handleChangeName=s.handleChangeName.bind(Object(o.a)(s)),s.renderPropertyValue=s.renderPropertyValue.bind(Object(o.a)(s)),s.patchName=s.patchName.bind(Object(o.a)(s)),s.state={selectedUserId:"",selectedUserInfo:{},newName:""},s}return Object(c.a)(a,[{key:"callRest",value:function(e,t,a,s){t.startsWith("/")&&(t=t.substr(1));var n=new XMLHttpRequest;n.open(e,m.getState().url+t),n.setRequestHeader("Content-type","application/json"),n.setRequestHeader("Accept","application/json"),n.withCredentials=!0;var r=m.getState().loginToken;r&&n.setRequestHeader("X-MSTR-AuthToken",r),n.onreadystatechange=s;try{n.send(a)}catch(i){console.log(i),alert("error: could not send http request")}}},{key:"cleanPropertyName",value:function(e){return(e=e.charAt(0).toUpperCase()+e.substr(1)).replace(/([A-Z]+)/g," $1").replace(/([A-Z][a-z])/g," $1")}},{key:"patchName",value:function(){var e=this.state.selectedUserInfo.id,t={operationList:[{op:"REPLACE",path:"/fullName",value:this.state.newName}]};this.callRest("PATCH","users/"+e,JSON.stringify(t),(function(){this.readyState===XMLHttpRequest.DONE&&alert("Name has been updated")}));var a=this.state.selectedUserId,s=m.getState().users.findIndex((function(e){return e.id===a})),n=m.getState().users;n[s].name=this.state.newName,m.dispatch({type:"update_users",newUsers:n})}},{key:"handleChangeName",value:function(e){this.setState({newName:e.target.value}),"Enter"===e.key&&this.patchName()}},{key:"renderPropertyValue",value:function(e,t){if(e.indexOf("date")>=0)try{return new Date(t).toLocaleString()}catch(a){}else if("fullName"===e)return Object(h.jsx)("input",{type:"text",defaultValue:t,onChange:this.handleChangeName},this.state.selectedUserInfo.id);return t}},{key:"updateUserId",value:function(e){this.setState({selectedUserId:e});var t=this;e&&this.callRest("GET","users/"+e,"",(function(){this.readyState===XMLHttpRequest.DONE&&t.setState({selectedUserInfo:JSON.parse(this.responseText)})}))}},{key:"render",value:function(){var e=this,t=[],a=this.state.selectedUserInfo,s="none";if(a&&a.id)try{["username","fullName","id","abbreviation","dateCreated","dateModified"].forEach((function(s,n){return a[s]?t.push(Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:e.cleanPropertyName(s)}),Object(h.jsx)("td",{children:e.renderPropertyValue(s,a[s])})]},a.id+n)):null})),s="table"}catch(n){console.log(n)}return Object(h.jsxs)("div",{className:"App",children:[Object(h.jsxs)("header",{className:"App-header",children:[Object(h.jsx)("img",{src:p,className:"App-logo",alt:"logo"}),Object(h.jsx)("span",{className:"App-title",children:"React User Manager"}),Object(h.jsx)("img",{src:p,className:"App-logo",alt:"logo"})]}),Object(h.jsxs)("div",{className:"container",children:[Object(h.jsxs)("div",{className:"fixed",children:[Object(h.jsxs)("div",{className:"panel-title",children:["List of Users",Object(h.jsx)("div",{className:"subtitle",children:"Select user below to get user information"})]}),Object(h.jsx)("ul",{children:m.getState().users&&Array.isArray(m.getState().users)&&m.getState().users.length>0?m.getState().users.map(function(e){var t=this;return Object(h.jsxs)("li",{className:"user",onClick:function(){return t.updateUserId(e.id)},children:[" ",e.name," "]},e.id)}.bind(this)):Object(h.jsx)("li",{children:"No users available"})})]}),Object(h.jsxs)("div",{className:"flex-item",children:[Object(h.jsx)("div",{className:"panel-title",children:"User Properties"}),Object(h.jsxs)("table",{className:"user-editor",style:{display:s},children:[Object(h.jsx)("thead",{children:Object(h.jsxs)("tr",{children:[Object(h.jsx)("th",{children:"Property"}),Object(h.jsx)("th",{children:"Value"})]})}),Object(h.jsx)("tbody",{children:t})]}),Object(h.jsx)("button",{className:"submit-button user-editor",style:{display:s},onClick:this.patchName,children:"Update Name"})]}),Object(h.jsxs)("div",{className:"right-panel",children:[Object(h.jsx)("div",{className:"panel-title",children:"REST Call Log"}),Object(h.jsx)(j,{})]})]}),Object(h.jsx)(O,{callRest:this.callRest})]})}}]),a}(s.Component),y=function(){return i.a.render(Object(h.jsx)(n.a.StrictMode,{children:Object(h.jsx)(f,{})}),document.getElementById("root"))};(function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,22)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,r=t.getLCP,i=t.getTTFB;a(e),s(e),n(e),r(e),i(e)}))})(),y(),m.subscribe(y)},9:function(e,t,a){}},[[21,1,2]]]);
//# sourceMappingURL=main.838a6011.chunk.js.map